<html>
<!-- Copied from https://htdp.org/2003-09-26/Problems/Solutions/sol7.html by Cyotek WebCopy 1.8.0.652, 01 July 2020, 17:43:44 --><head><title>HtDP Solution Set</title></head><body bgcolor="white"><br><table width="100%"><tr><td align="left"><h3>HtDP Solution Set</h3></td><td align="right"><h3>Section 7</h3></td></tr></table><pre><br></pre><p><hr><a name="PROBLEM1"><font color="red">Problem 1 (Solution): </font></a><blockquote><pre>; A Document-Summary is one of<br>;  (make-letter Symbol Symbol Symbol)<br>;  (make-memo Symbol Symbol Symbol Symbol)<br>;  (make-resume Symbol Symbol Boolean)<br>&nbsp;<br>(define-struct letter (to date signature))<br>(define-struct memo (from to date subject))<br>(define-struct resume (name date sent?))<br>&nbsp;<br>;;from : Document-Summary -&gt; Symbol<br>;; - return who the document is from<br>(define (from a-doc)<br>  (cond<br>   [(letter? a-doc) (letter-signature a-doc)]<br>   [(memo? a-doc) (memo-from a-doc)]<br>   [(resume? a-doc) (resume-name a-doc)]))<br>&nbsp;<br>#|TESTS|#<br>(from (make-letter 'Mike 'Feb-14 'Kate))<br>"should be" 'Kate<br>(from (make-memo 'Chris 'Jean 'Jan-22 'Budget))<br>"should be" 'Chris<br>(from (make-resume 'Tara 'May-1 false))<br>"should be" 'Tara<br>&nbsp;<br>&nbsp;<br></pre></blockquote><p><hr><a name="PROBLEM2"><font color="red">Problem 2 (Solution): </font></a><blockquote><pre>; A 3dshape is one of<br>;  (make-cube Number)<br>;  (make-prism Number Number Number)<br>;  (make-sphere Number)<br>&nbsp;<br>(define-struct cube (edge))<br>(define-struct prism (length width height))<br>(define-struct sphere (radius))<br>&nbsp;<br>;;volume: 3dshape -&gt; Number<br>;  return volume of shape<br>(define (volume a-3dshape)<br>  (cond<br>   [(cube? a-3dshape) (expt (cube-edge a-3dshape) 3)]<br>   [(prism? a-3dshape) (* (prism-length a-3dshape)<br>			  (prism-width a-3dshape)<br>			  (prism-height a-3dshape))]<br>   [(sphere? a-3dshape) <br>    (* 4/3 pi (expt (sphere-radius a-3dshape) 3))]))<br>&nbsp;<br>#| TESTS |#<br>(volume (make-cube 2))<br>"should be" 8<br>(volume (make-prism 2 3 4))<br>"should be" 24<br>(volume (make-sphere 2))<br>"should be" (* 4/3 8 pi)<br>&nbsp;<br>&nbsp;<br>&nbsp;<br></pre></blockquote><p><hr><a name="PROBLEM3"><font color="red">Problem 3 (Solution): </font></a><blockquote><pre>; A train is one of<br>;  (make-commuter Number Number Boolean)<br>;  (make-amtrak Number Number Symbol)<br>;  (make-subway Number Number Symbol)<br>&nbsp;<br>(define-struct commuter (cars ppc allstops?))<br>(define-struct amtrak (cars ppc type))<br>(define-struct subway (cars ppc color))<br>&nbsp;<br>;;capacity : Train -&gt; Number<br>; - return passenger capacity of train<br>(define (capacity a-train)<br>  (cond<br>   [(commuter? a-train)<br>    (* (commuter-cars a-train) (commuter-ppc a-train))]<br>   [(amtrak? a-train)<br>    (* (amtrak-cars a-train) (amtrak-ppc a-train))]<br>   [(subway? a-train) <br>    (* (subway-cars a-train) (subway-ppc a-train))]))<br>&nbsp;<br>;;hold-all? : Train Number -&gt; Boolean<br>;  - return true if train will hold number of passengers, <br>;    false otherwise<br>(define (hold-all? a-train passengers)<br>  (&lt;= passengers (capacity a-train)))<br>&nbsp;<br>&nbsp;<br>#| TESTS |#<br>(capacity (make-commuter 10 20 true))<br>"should be" 200<br>(capacity (make-amtrak 30 30 'Limited))<br>"should be" 900<br>(capacity (make-subway 15 40 'blue))<br>"should be" 600<br>&nbsp;<br>(hold-all? (make-commuter 10 60 false) 600)<br>"should be" true<br>(hold-all? (make-amtrak 15 40 true) 200)<br>"should be" true<br>(hold-all? (make-subway 10 35 'red) 351)<br>"should be" false<br>&nbsp;<br>&nbsp;<br></pre></blockquote><p><hr><a name="PROBLEM4"><font color="red">Problem 4 (Solution): </font></a><blockquote><pre>;An employee is one of<br>;  (make-principal Number Number Symbol)<br>;  (make-teacher Number Number Symbol)<br>;  (make-assistant Number Number Symbol)<br>&nbsp;<br>(define-struct principal (salary office degree))<br>(define-struct teacher (salary classroom degree))<br>(define-struct assistant (wage hours degree))<br>&nbsp;<br>;tax : Employee Number -&gt; Number<br>; - compute social security tax for employee<br>(define (tax an-emp rate)<br>  (cond<br>   [(principal? an-emp) (* (principal-salary an-emp) rate)]<br>   [(teacher? an-emp) (* (teacher-salary an-emp) rate)]<br>   [(assistant? an-emp) (* (assistant-wage an-emp)<br>			   (assistant-hours an-emp)<br>			   rate)]))<br>&nbsp;<br>#| TESTS |#<br>(tax (make-principal 100000 201 'MS) .075)<br>"should be" 7500<br>(tax (make-teacher 50000 222 'BS) .15)<br>"should be" 7500<br>(tax (make-assistant 25 40 'Diploma) .10)<br>"should be" 100<br>&nbsp;<br></pre></blockquote><p><hr><a name="PROBLEM5"><font color="red">Problem 5 (Solution): </font></a><blockquote><pre>; An Account is one of<br>;   (make-checking Number Number)<br>;   (make-savings Number Number)<br>;   (make-credit Number Number Number)<br>&nbsp;<br>; A Response is one of<br>;  - Account<br>;  - 'Error<br>&nbsp;<br>(define-struct checking (balance trans))<br>(define-struct savings (balance trans))<br>(define-struct credit (balance limit trans))<br>&nbsp;<br>;withdrawal: Account Number -&gt; Response<br>;  - process a withdrawal request and return an updated account or 'Error<br>(define (withdrawal acct amt)<br>  (cond<br>   [(checking? acct)<br>    (cond<br>     [(&lt; (- (checking-balance acct) amt) -1000)<br>      'Error]<br>     [else<br>      (make-checking<br>       (- (checking-balance acct) amt)<br>       (+ (checking-trans acct) 1))])]<br>   [(savings? acct)<br>    (cond<br>     [(&lt; (- (savings-balance acct) amt) 0)<br>      'Error]<br>     [else<br>      (make-savings<br>       (- (savings-balance acct) amt)<br>       (+ (savings-trans acct) 1))])]<br>   [(credit? acct)<br>    (cond<br>     [(&lt; (credit-limit acct) (+ (credit-balance acct) amt))<br>      'Error]<br>     [else<br>      (make-credit<br>       (+ (credit-balance acct) amt)<br>       (credit-limit acct)<br>       (+ (credit-trans acct) 1))])]))<br>&nbsp;<br>#| TESTS |#<br>&nbsp;<br>(withdrawal (make-savings 10 10) 10)<br>"should be" (make-savings 0 11)<br>(withdrawal (make-savings 20 1) 21)<br>"should be" 'Error<br>&nbsp;<br>(withdrawal (make-checking -999 10) 1)<br>"should be" (make-checking -1000 11)<br>(withdrawal (make-checking -999 10) 2)<br>"should be" 'Error<br>&nbsp;<br>(withdrawal (make-credit 10 1000 1) 990)<br>"should be" (make-credit 1000 1000 2)<br>(withdrawal (make-credit 1000 1000 2) 1)<br>"should be" 'Error<br>&nbsp;<br></pre></blockquote><br><hr><table width="90%"><tr><td align="left"><address><a href="../../../cdn-cgi/l/email-protection.html#6b190a120604050f2b08081845050e1e450e0f1e">Jamie Raymond</a></address></td><td align="right"><address>Matthias Felleisen</address></td></tr><tr><td align="left">&nbsp;</td><td align="right"><p>23 september 2002 </p></td></tr></table><script data-cfasync="false" src="../../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body><!-- Copied from https://htdp.org/2003-09-26/Problems/Solutions/sol7.html by Cyotek WebCopy 1.8.0.652, 01 July 2020, 17:43:44 -->
</html>
<html>
<!-- Copied from https://htdp.org/2003-09-26/Problems/Solutions/sol14.html by Cyotek WebCopy 1.8.0.652, 01 July 2020, 17:43:44 --><head><title>HtDP Solution Set</title></head><body bgcolor="white"><br><table width="100%"><tr><td align="left"><h3>HtDP Solution Set</h3></td><td align="right"><h3>Section 14</h3></td></tr></table><pre><br></pre><p><hr><a name="PROBLEM1"><font color="red">Problem 1 (Solution): </font></a><blockquote><pre>#|<br>An ft-node is one of<br>  empty or<br>  child<br>&nbsp;<br>A child is a structure<br>  (make-child ft-node ft-node symbol number symbol)<br>&nbsp;<br>A list-of-symbol is one of<br>  empty or<br>  (cons symbol list-of-symbol)<br>|#<br>&nbsp;<br>(define-struct child (father mother name birthyear eyes))<br>&nbsp;<br>&nbsp;<br>(define gms (make-child empty empty 'erma 1880 'blue))<br>(define gps (make-child empty empty 'john 1876 'blue))<br>(define gmh (make-child empty empty 'mary 1856 'blue))<br>(define gph (make-child empty empty 'reuben 1840 'green))<br>(define ph (make-child gph gmh 'charles 1903 'blue))<br>(define mh (make-child gps gms 'betty 1902 'brown))<br>(define mom (make-child ph mh 'stacy 1952 'brown))<br>(define mr (make-child empty empty 'margaret 1902 'green))<br>(define pr (make-child empty empty 'james 1900 'brown))<br>(define dad (make-child pr mr 'jim 1946 'brown))<br>(define me (make-child dad mom 'jamie 1970 'brown))<br>&nbsp;<br>;mothers-names : ft-node -&gt; list-of-symbol<br>(define (mothers-names atree)<br>  (cond<br>    [(empty? atree) empty]<br>    [(child? atree) (append (mother-s-name atree)<br>                            (mothers-names (child-mother atree))<br>                            (mothers-names (child-father atree)))]))<br>&nbsp;<br>; mother-s-name : child -&gt; list-of-symbol<br>(define (mother-s-name achild)<br>  (cond<br>    [(empty? (child-mother achild)) empty]<br>    [else (cons (child-name (child-mother achild)) empty)]))<br>&nbsp;<br>&nbsp;<br>#| Tests |#<br>(mothers-names empty)<br>"should be" empty<br>(mothers-names dad)<br>"should be" (cons 'margaret empty)<br>(mothers-names me)<br>"should be" (cons 'stacy (cons 'betty (cons 'erma (cons 'mary (cons 'margaret empty)))))<br>&nbsp;<br>&nbsp;<br></pre></blockquote><p><hr><a name="PROBLEM2"><font color="red">Problem 2 (Solution): </font></a><blockquote><pre>;born-after : number ft-node -&gt; list-of-symbol<br>;  produce list of name of people born after given year<br>(define (born-after ayear atree)<br>  (cond<br>    [(empty? atree) empty]<br>    [(child? atree)<br>     (append (check-child-year ayear atree)<br>             (born-after ayear (child-father atree))<br>             (born-after ayear (child-mother atree)))]))<br>&nbsp;<br>;check-child-year : number child -&gt; list-of-symbol<br>;  return list of name if birth year is less than given year<br>(define (check-child-year ayear achild)<br>  (cond<br>    [(&gt; (child-birthyear achild) ayear) (cons (child-name achild) empty)]<br>    [else empty]))<br>&nbsp;<br>#| Tests |#<br>(check-child-year 1910 me) "should be"  (cons 'jamie empty)<br>(check-child-year 1986 me) "should be" empty<br>&nbsp;<br>(born-after 2002 empty) "should be" empty<br>(born-after 2002 me) "should be" empty<br>(born-after 1900 me) <br>"should be" <br>  (cons 'jamie<br>        (cons 'jim<br>              (cons 'margaret<br>                    (cons 'stacy<br>                          (cons 'charles<br>                                (cons 'betty empty))))))<br>&nbsp;<br></pre></blockquote><p><hr><a name="PROBLEM3"><font color="red">Problem 3 (Solution): </font></a><blockquote><pre>#|<br>A Web-page (shor: WP) is one of:<br>  1. empty<br>  2. (cons symbol WP)<br>  3. (cons WP WP)<br>|#<br>&nbsp;<br>; remove-wp : WP -&gt; WP<br>(define (remove-wp awp)<br>  (cond<br>    [(empty? awp) empty]<br>    [(symbol? (first awp)) (cond<br>                             [(symbol=? (first awp) '%remove) empty]<br>                             [else (cons (first awp) (remove-wp (rest awp)))])]<br>    [else (cons (remove-wp (first awp)) (remove-wp (rest awp)))]))<br>&nbsp;<br>#| Tests |#<br>(remove-wp empty)<br>"should be" empty<br>&nbsp;<br>(remove-wp<br>  (cons 'TeachScheme <br>        (cons 'Webpage<br>              (cons (cons '%remove (cons 'Lecture (cons 'Notes (cons 'for (cons 'Teachers empty)))))<br>                    (cons (cons 'DrScheme empty)<br>                          empty)))))<br>"should be" <br>(cons 'TeachScheme (cons 'Webpage (cons empty (cons (cons 'DrScheme empty) empty))))<br>&nbsp;<br></pre></blockquote><p><hr><a name="PROBLEM4"><font color="red">Problem 4 (Solution): </font></a><blockquote><pre>#|<br>A File is a structure<br>   (make-file symbol string)<br>|#<br>&nbsp;<br>(define-struct file (name contents))<br>&nbsp;<br>#|<br>A P2P-Network is one of<br> - empty <br> - (make-node number list-of-file P2P-Network)<br>&nbsp;<br>A list-of-file is one of<br>  - empty or<br>  - (cons File list-of-file)<br>|#<br>&nbsp;<br>(define-struct node (address files neighbor))<br>&nbsp;<br>;p2p-search : symbol P2P-Network -&gt; number or false<br>;  return address of node containing item or false if not in network<br>(define (p2p-search item net)<br>  (cond<br>    [(empty? net) false]<br>    [else (cond<br>            [(in-node? item (node-files net)) (node-address net)]<br>            [else (p2p-search item (node-neighbor net))])]))<br>&nbsp;<br>;in-node? : symbol list-of-file -&gt; boolean<br>;  looks for item in node's list of files<br>(define (in-node? item files)<br>  (cond<br>    [(empty? files) false]<br>    [else (or (symbol=? item (file-name (first files)))<br>              (in-node? item (rest files)))]))<br>&nbsp;<br>;p2p-search-all : symbol P2P-Network -&gt; list-of-number<br>;  produce addresses of all nodes hosting file<br>(define (p2p-search-all item net)<br>  (cond<br>    [(empty? net) empty]<br>    [else<br>     (cond<br>       [(in-node? item (node-files net))<br>        (cons (node-address net)<br>              (p2p-search-all item (node-neighbor net)))]<br>       [else (p2p-search-all item (node-neighbor net))])]))<br>&nbsp;<br>#| Tests |#<br>(define f1 (make-file 'earth "the earth is great"))<br>(define f2 (make-file 'rain "i like rain too"))<br>(define f3 (make-file 'fire "burn fire burn"))<br>(define n1 (make-node 1001 empty empty))<br>(define n2 (make-node 1002 (cons f2 empty) n1))<br>(define n3 (make-node 1003 (cons f3 (cons f2 (cons f1 empty))) n2))<br>&nbsp;<br>(in-node? 'rain empty) "should be" false<br>(in-node? 'rain (cons f1 (cons f2 empty))) "should be" true<br>&nbsp;<br>(p2p-search 'rain n1) "should be" false<br>(p2p-search 'rain n2) "should be" 1002<br>(p2p-search 'rain n3) "should be" 1003<br>&nbsp;<br>(p2p-search-all 'rain n1) "should be" empty<br>(p2p-search-all 'rain n3) "should be" (cons 1003 (cons 1002 empty))<br>&nbsp;<br></pre></blockquote><p><hr><a name="PROBLEM5"><font color="red">Problem 5 (Solution): </font></a><blockquote><pre>;p2p-get : symbol number P2P-Network -&gt; string<br>;  return contents of file from a particular node or false<br>(define (p2p-get item address net)<br>  (cond<br>    [(empty? net) (error 'pgp-get "can't happen")]<br>    [else (cond<br>            [(= (node-address net) address) <br>             (get-file-contents item (node-files net))]<br>            [else (p2p-get item address (node-neighbor net))])]))<br>&nbsp;<br>;get-file-contents : symbol list-of-file -&gt; string or false<br>(define (get-file-contents item files)<br>  (cond<br>    [(empty? files) false]<br>    [else (cond<br>            [(symbol=? item (file-name (first files))) <br>             (file-contents (first files))]<br>            [else (get-file-contents item (rest files))])]))<br>&nbsp;<br>#| Tests |#<br>(get-file-contents 'rain empty) "should be" false<br>(get-file-contents 'rain (cons f1 (cons f2 (cons f3 empty)))) "should be" "i like rain too"<br>&nbsp;<br>(p2p-get 'rain 1002 n2) "should be" "i like rain too"<br>(p2p-get 'fire 1003 n3) "should be" "burn fire burn"<br></pre></blockquote><br><hr><table width="90%"><tr><td align="left"><address><a href="../../../cdn-cgi/l/email-protection.html#daa8bba3b7b5b4be9ab9b9a9f4b4bfaff4bfbeaf">Jamie Raymond</a></address></td><td align="right"><address>Matthias Felleisen</address></td></tr><tr><td align="left">&nbsp;</td><td align="right"><p>23 september 2002 </p></td></tr></table><script data-cfasync="false" src="../../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body><!-- Copied from https://htdp.org/2003-09-26/Problems/Solutions/sol14.html by Cyotek WebCopy 1.8.0.652, 01 July 2020, 17:43:44 -->
</html>